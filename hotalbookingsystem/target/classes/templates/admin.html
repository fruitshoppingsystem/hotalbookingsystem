<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    	<!-- Mobile Web-app fullscreen -->
    	<meta name="apple-mobile-web-app-capable" content="yes">
    	<meta name="mobile-web-app-capable" content="yes">

    	<!-- Meta tags -->
    	<meta name="description" content="">
    	<meta name="author" content="">
    	<link rel="icon" href="favicon.ico">

    	<!--Title-->
		<title>管理员个人界面</title>
		<!--CSS styles-->
    	<link rel="stylesheet" media="all" href="css/bootstrap.css" />
    	<link rel="stylesheet" media="all" href="css/animate.css" />
    	<link rel="stylesheet" media="all" href="css/font-awesome.css" />
    	<link rel="stylesheet" media="all" href="css/linear-icons.css" />
    	<link rel="stylesheet" media="all" href="css/hotel-icons.css" />
    	<link rel="stylesheet" media="all" href="css/magnific-popup.css" />
    	<link rel="stylesheet" media="all" href="css/owl.carousel.css" />
    	<link rel="stylesheet" media="all" href="css/datepicker.css" />
    	<link rel="stylesheet" media="all" href="css/theme.css" />

    	<!--Google fonts-->
    	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,500&amp;subset=latin-ext" rel="stylesheet">
    	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700&amp;subset=latin-ext" rel="stylesheet">


    	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    	<!--[if lt IE 9]>
    	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    	<![endif]-->
    	<script type="text/javascript">
			window.onload = function(){
				document.getElementById("showbox1").onclick = function(){
					document.getElementById("box2").style.display = "none";
					document.getElementById("box3").style.display = "none";
					document.getElementById("box1").style.display = "block";
				}
				document.getElementById("showbox2").onclick = function(){
					document.getElementById("box1").style.display = "none";
					document.getElementById("box3").style.display = "none";
					document.getElementById("box2").style.display = "block";
				}
				document.getElementById("showbox3").onclick = function(){
					document.getElementById("box1").style.display = "none";
					document.getElementById("box2").style.display = "none";
					document.getElementById("box3").style.display = "block";
				}
			}
		</script>
	</head>
	<body>
		<div class="page-loader"></div>
		
		<div class="wrapper">

        <header>

            <!-- ======================== Navigation ======================== -->

            <div class="container">

                <!-- === navigation-top === -->

                <nav class="navigation-top clearfix">
					<!-- navigation-top-left -->

                    <div class="navigation-top-left">
                        
                    </div>

                    <!-- navigation-top-right -->

                    <div class="navigation-top-right">
                        <a class="box" href="index.html">
                            <i class="glyphicon glyphicon-log-out"></i> 
                            	退出登录
                        </a>
                    </div>
                </nav>

                <!-- === navigation-main === -->

                <nav class="navigation-main clearfix">

                    <!-- logo -->

                    <div class="logo animated fadeIn">
                        <a href="index.html">
                            <img class="logo-desktop" src="images/logo.png" alt="Alternate Text" />
                            <img class="logo-mobile" src="images/logo-mobile.png" alt="Alternate Text" />
                        </a>
                    </div>

                    <!-- toggle-menu -->

                    <div class="toggle-menu"><i class="icon icon-menu"></i></div>

                    <!-- navigation-block -->

                    <div class="navigation-block clearfix">

                        <!-- navigation-left -->

                        <ul class="navigation-left" role="tablist">
                            <li role="presentation" class="active">
                                <a id="showbox1">房间管理 </a>
                            </li>
                            <li role="presentation">
                                <a id="showbox2">评论管理 </a>
                            </li>
                            <li role="presentation">
                                <a id="showbox3">审核 </a>
                            </li>
                        </ul>

                        <!-- navigation-right -->

                        <ul class="navigation-right">
                            
                        </ul>

                    </div> <!--/navigation-block-->

                </nav>
            </div> <!--/container-->

        </header>
        
        <!-- ========================  Facility ======================== -->

        <section class="page">

            <!-- ===  Page header === -->

            <div class="page-header" style="background-image:url(images/header-1.jpg)">
                <div class="container text-center">
					<h2 class="title"><p th:text="${admin.AName}"></p></h2>
                    <p>欢迎登录</p>
                </div>
            </div>

			<div class="checkout">
                <div class="container">
                	<div class="clearfix">
                		<div class="content" id="box1" align="center" style="display: block;">
                    		<h4 class="title">房间管理</h4>
                    		<a th:href="@{/addRoomPage(aId=${aId})}"><button class="btn btn-main btn-block">添加房间</button></a>
                    		<table class="table table-hover table-striped table-bordered table-condensed">
								<thead>
								<tr>
									<td>房间号</td>
									<td>房间类型</td>
									<td>房间楼层</td>
									<td>房间方位</td>
									<td>状态</td>
									<td>操作</td>
								</tr>
								</thead>
								<tbody>
								<tr th:each="room:${rooms}">
									<td th:text="${room.roomId}"></td>
									<td th:text="${room.roomType}"></td>
									<td th:text="${room.roomFloor}"></td>
									<td th:text="${room.roomOrientation}"></td>
									<td th:text="${room.roomState}"></td>
									<td>
										<a th:href="@{/updateRoomPage(roomId=${room.roomId}, aId=${aId})}"><button class="btn btn-clean-dark">修改房间</button></a>
										<a><button class="btn btn-clean-dark" th:onclick="|deleteRoom(${room.roomId})|">删除房间</button></a>
									</td>
								</tr>
								</tbody>
							</table>
                		</div>
                		<div class="content" id="box2" align="center" style="display: none;">
                    		<h4 class="title">评论管理</h4>
                    		<table class="table table-hover table-striped table-bordered table-condensed">
								<thead>
								<tr>
									<td>评论编号</td>
									<td>评论人</td>
									<td>评论时间</td>
									<td>房间类型</td>
									<td>评论内容</td>
									<td>操作</td>
								</tr>
								</thead>
								<tbody>
								<tr th:each="comment:${comments}">
									<td th:text="${comment.CId}"></td>
									<td th:text="${comment.UName}"></td>
									<td th:text="${comment.CTime}"></td>
									<td th:text="${comment.roomType}"></td>
									<td th:text="${comment.CContent}"></td>
									<td>
										<button class="btn btn-clean-dark" th:onclick="|deleteComment(${comment.CId})|">删除评论</button>
									</td>
								</tr>
								</tbody>
							</table>
                		</div>
                		<div class="content" id="box3" align="center" style="display: none;">
                			<h4 class="title">审核退订申请</h4>
							<table class="table table-hover table-striped table-bordered table-condensed">
								<thead>
								<tr>
									<td>订单号</td>
									<td>房间类型</td>
									<td>到达日期</td>
									<td>离开日期</td>
									<td>预订天数</td>
									<td>客人数量</td>
									<td>客人名称</td>
									<td>客人电话</td>
									<td>客人身份证号</td>
									<td>总金额</td>
									<td>订单状态</td>
									<td>操作</td>
								</tr>
								</thead>
								<tbody>
								<tr th:each="order:${orders}">
									<td th:text="${order.OId}"></td>
									<td th:text="${order.roomType}"></td>
									<td th:text="${order.ATime}"></td>
									<td th:text="${order.LTime}"></td>
									<td th:text="${order.dayNum}"></td>
									<td th:text="${order.UNum}"></td>
									<td th:text="${order.UName}"></td>
									<td th:text="${order.UPhone}"></td>
									<td th:text="${order.UIDCard}"></td>
									<td th:text="${order.totalPrise}"></td>
									<td th:text="${order.OState}"></td>
									<td>
										<button class="btn btn-clean-dark" th:onclick="|refund(${order.OId})|">退款</button>
									</td>
								</tr>
								</tbody>
							</table>
                       	</div> <!--/content-->
    				</div>
    			</div>
    		</div>
        </section>

		<br />
        <!-- ========================  Subscribe ======================== -->

        <section class="subscribe">
            <div class="container">
                <div class="box">
                    <h2 class="title">感谢</h2>
                    <div class="text">
                        <p>非常感谢各位客户的支持</p>
                    </div>
                    <a href="contact.html"><button class="btn btn-clean">联系我们</button></a>
                </div>
            </div>
        </section> 

        <!-- ================== Footer  ================== -->

        <footer>
            <div class="container">

                <!--footer social-->

                <div class="footer-social">
                    <div class="row">
                        <div class="col-sm-12 text-center hidden">
                            <a href="" class="footer-logo"><img src="images/logo.png" alt="Alternate Text" /></a>
                        </div>
                        <div class="col-sm-12 icons">
                            
                        </div>
                        <div class="col-sm-12 copyright">
                            
                        </div>
                        <div class="col-sm-12 text-center">
                            <img src="images/logo-footer.png" alt="" />
                        </div>
                    </div>
                </div>
            </div>
        </footer>

    </div> <!--/wrapper-->
		<form id="form">
		</form>
    <!--JS files-->
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/jquery.bootstrap.js"></script>
    <script src="js/jquery.magnific-popup.js"></script>
    <script src="js/jquery.owl.carousel.js"></script>
    <script src="js/main.js"></script>
		<script th:inline="javascript">
			function deleteRoom(roomId) {
				var aId = [[${aId}]];
				$.ajax({
					async:false,
					url : "/room/deleteRoom",
					datatype : "String",
					type : "post",
					data:{
						roomId:roomId
					},success:function (res) {
						if (res === true){
							alert("删除成功");
							document.getElementById("form").action="/adminPage?aId="+aId;
							document.getElementById("form").method="post";
							document.getElementById("form").submit();
						}else{
							alert("删除失败");
						}
					},error:function () {
						alert("失败");
					}
				});
			}
			function deleteComment(cId) {
				var aId = [[${aId}]];
				$.ajax({
					async:false,
					url : "/comment/deleteComment",
					datatype : "String",
					type : "post",
					data:{
						cId:cId
					},success:function (res) {
						if (res === true){
							alert("删除成功");
							document.getElementById("form").action="/adminPage?aId="+aId;
							document.getElementById("form").method="post";
							document.getElementById("form").submit();
						}else{
							alert("删除失败");
						}
					},error:function () {
						alert("失败");
					}
				});
			}
			function refund(oId) {
				var aId = [[${aId}]];
				$.ajax({
					async:false,
					url : "/refund",
					datatype : "String",
					type : "post",
					data:{
						oId:oId
					},success:function () {
						$.ajax({
							async:false,
							url : "/order/unsubscribeR",
							datatype : "String",
							type : "post",
							data:{
								oId:oId
							},success:function (res) {
								if (res === true){
									alert("退款成功");
									document.getElementById("form").action="/adminPage?aId="+aId;
									document.getElementById("form").method="post";
									document.getElementById("form").submit();
								}else {
									alert("退款失败");
								}
							},error:function () {
								alert("失败");
							}
						});
					},error:function () {
						alert("失败");
					}
				});
			}
		</script>
	</body>
</html>
